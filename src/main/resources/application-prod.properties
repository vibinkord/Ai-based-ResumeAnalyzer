################################################################################
# Production Profile Configuration
# 
# Activated with: -Dspring.profiles.active=prod or SPRING_PROFILES_ACTIVE=prod
# 
# Features:
# - Minimal logging (INFO level only)
# - File-based logging with rotation
# - Security hardening
# - Performance optimizations
# - Strict validation
# - External configuration via environment variables
#
################################################################################

# ============================================================================
# Server Configuration (Production)
# ============================================================================
# Server port - should be behind a reverse proxy
server.port=8080
server.servlet.context-path=/

# Graceful shutdown
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=60s

# ============================================================================
# Logging Configuration (Production)
# ============================================================================
# Minimal logging in production
logging.level.root=INFO
logging.level.com.resumeanalyzer=INFO
logging.level.org.springframework=WARN
logging.level.org.springframework.web=INFO
logging.level.org.apache.pdfbox=WARN

# File-based logging only
logging.file.name=/var/log/resume-analyzer/resume-analyzer.log
logging.file.max-size=100MB
logging.file.max-history=90
logging.file.total-size-cap=5GB
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# ============================================================================
# Resume Analysis Configuration (Production)
# ============================================================================
# Strict file size limits in production
resume.analyzer.max-resume-size=51200
resume.analyzer.max-job-description-size=51200
resume.analyzer.min-text-length=10

# ============================================================================
# File Upload Configuration (Production)
# ============================================================================
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB

# ============================================================================
# Gemini API Configuration (Production)
# ============================================================================
# CRITICAL: Use environment variable for API key
gemini.api.key=${GEMINI_API_KEY}
gemini.api.url=https://generativelanguage.googleapis.com/v1beta/models/gemini-flash-latest:generateContent

# AI suggestions enabled with fallback
resume.analyzer.ai-suggestions.enabled=true
resume.analyzer.ai-suggestions.fallback-to-rules=true
resume.analyzer.ai-suggestions.timeout-seconds=30
resume.analyzer.ai-suggestions.max-retries=3

# ============================================================================
# Security Configuration (Production)
# ============================================================================
# Strict security in production
security.input-validation.enabled=true
security.sanitize-input=true
security.block-sql-injection=true
security.block-script-injection=true
security.block-null-bytes=true
security.max-request-size-bytes=52428800

# CORS - restrict to specific domains
spring.web.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://example.com}
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.max-age=3600

# ============================================================================
# Feature Flags (Production)
# ============================================================================
# All features enabled in production
features.health-check.enabled=true
features.skills-list.enabled=true
features.batch-analysis.enabled=true
features.resume-comparison.enabled=true
features.file-upload.enabled=true
features.ai-suggestions.enabled=true

# ============================================================================
# API Documentation (Production)
# ============================================================================
# Swagger disabled in production for security
springdoc.swagger-ui.enabled=false

# ============================================================================
# Performance & Caching (Production)
# ============================================================================
# Enable caching in production
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=500,expireAfterWrite=600s

# Connection pool optimization
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# Database Configuration (Production)
# ============================================================================
# Database connection from environment variables (CRITICAL for security)
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration (Production)
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Flyway Configuration (Production)
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true
spring.flyway.out-of-order=false

# ============================================================================
# Actuator Configuration (Production)
# ============================================================================
# Limited actuator endpoints in production
management.endpoints.web.exposure.include=health,metrics
management.endpoint.health.show-details=when-authorized
management.metrics.enable.jvm=true
management.metrics.enable.process=true

# ============================================================================
# Error Handling (Production)
# ============================================================================
# Hide details in production
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

# ============================================================================
# Application Compression (Production)
# ============================================================================
server.compression.enabled=true
server.compression.min-response-size=1024
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# ============================================================================
# Session Configuration (Production)
# ============================================================================
server.servlet.session.timeout=30m
server.servlet.session.tracking-modes=cookie

# ============================================================================
# JWT Configuration (Production)
# ============================================================================
# CRITICAL: Use environment variables for secret key and expiration
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:3600000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# ============================================================================
# Spring Security Configuration (Production)
# ============================================================================
# Enhanced security for production
security.password-min-length=8
logging.level.org.springframework.security=WARN
